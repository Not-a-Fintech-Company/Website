# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Astro + Starlight static site for [Not a Fintech Company](https://www.notafintech.co) — an open-source knowledge base for fintech founders. Licensed under CC0 1.0. Deployed on Cloudflare Pages at `notafintech.pages.dev` with primary domain `www.notafintech.co` (`notafintech.co` redirects to `www` via Cloudflare rules). Contact email: hello@notafintech.co.

Previously a Jekyll 4.x site on GitHub Pages — fully migrated to Astro in February 2026. No Jekyll files remain.

## Build Commands

```bash
npm install        # Install dependencies
npm run dev        # Local dev server at http://localhost:4321
npm run build      # Production build (output to dist/)
npm run preview    # Preview production build locally
```

There are no test or lint commands — this is a content-focused static site.

## Architecture

**Framework**: Astro 5.x with Starlight documentation theme. Static output (`output: 'static'`). Dev toolbar disabled.

**Configuration**: `astro.config.mjs` is the central config — Starlight integration, sidebar structure, analytics scripts, SEO meta tags, custom CSS, and component overrides are all defined here.

**Content**: All pages live in `src/content/docs/` as Markdown (`.md`) or MDX (`.mdx`). MDX is used only when a page needs the `GoogleEmbed` component for Google Sheets iframes. Content schema is defined in `src/content.config.ts` using Starlight's `docsSchema()`.

**Sidebar**: Guides, Models, and Docs sections auto-generate from their directories. Resources and About are linked individually by slug.

**Components**:
- `src/components/GoogleEmbed.astro` — sandboxed iframe wrapper for Google Sheets embeds
- `src/components/Footer.astro` — custom footer extending Starlight's default, adds CC0 license notice, Totavi hosting credit, and link to GitHub source repo

**Styling**: `src/styles/custom.css` overrides Starlight CSS variables for brand colors (`#284B9C`), Roboto font, content width, iframe containers, and light-theme logo inversion.

**Content sections** (each with its own `index.md`):
- `guides/` — Educational guides for fintech founders (6 guides)
- `models/` — Financial model templates with Google Sheets embeds (3 models)
- `docs/` — Compliance documentation: BSA policy (inline markdown), credit card trunk (iframe embed)

**Static assets**: `public/` contains favicon.png, apple-touch-icon.png, og-image.png (1200x630), siteicon.png, touch-icon.png, robots.txt, sitemap.xml, CNAME, and PDF/PPT downloads.

**Search**: Pagefind (built into Starlight). Index is generated at build time — only works in production builds, not `npm run dev`. Use `npm run preview` to test search locally.

## Content Conventions

- Pages use YAML frontmatter with `title` and `description`
- Homepage (`index.mdx`) uses Starlight's `template: splash` with a hero section and the NAFC Roadmap
- Google Sheets embeds use the `GoogleEmbed` component in `.mdx` files
- Google Docs content has been inlined as markdown (not iframed) — homepage roadmap and BSA policy
- Roadmap items on the homepage link to their corresponding pages where available
- Footer: CC0 license notice, Totavi hosting credit, GitHub source link
- Footer social links: GitHub only
- CHANGELOG.md tracks all site updates

## Analytics

Two services configured in `astro.config.mjs` head config:
- **Plausible Analytics** — script ID: `pa-W0Dq5s5xrg0nZbo6PsWi5`
- **Google Analytics** — measurement ID: `G-VJXL7WCFNM`

## SEO

Configured in `astro.config.mjs` head config:
- OpenGraph image (`og-image.png` at 1200x630) with width/height/type meta tags
- Twitter Card (`summary_large_image`)
- Apple touch icon (180x180)
- Theme color (`#284B9C`)
- Favicon (`/favicon.png`)
- Sitemap at `/sitemap-index.xml` (generated by `@astrojs/sitemap`), with a static `/sitemap.xml` redirect in `public/`
- `robots.txt` references both sitemap paths

## Deployment

**Host**: Cloudflare Pages with Git integration (auto-deploys on push to `main`).
- **Project name**: `notafintech` (on Cloudflare)
- **Build command**: `npm run build`
- **Build output directory**: `dist`
- **Primary domain**: `www.notafintech.co` (canonical)
- **Redirect**: `notafintech.co` → `www.notafintech.co` (Cloudflare redirect rule)
- **Pages URL**: `notafintech.pages.dev`

The `wrangler.jsonc` file is for local Wrangler CLI deploys only. Git-connected Pages deploys do not use it — Cloudflare's Pages build system handles deployment natively after running the build command. Do not set a deploy command in the Cloudflare dashboard for Pages projects.

See `DEPLOYMENT.md` for full setup instructions and `MIGRATION.md` for the Jekyll-to-Astro cutover steps.

## Security Conventions

- All `target="_blank"` links include `rel="noopener noreferrer"`
- All iframes include `sandbox="allow-scripts allow-same-origin"` and `title`
- No secrets or API keys in the repo — analytics IDs are public by design

## MDX Gotchas

- Angle-bracket autolinks (`<https://...>`) are invalid in `.mdx` — MDX interprets `<` as JSX. Use `[text](url)` syntax.
- URL query params in JSX props: use `&` not `&amp;` (JSX, not HTML).

## Logo

- `src/assets/logo.svg` — pie-chart icon only, uses `fill="currentColor"` for theme adaptation. No text.
- `src/assets/logo.png` — full logo with text, used for homepage hero image.
- Light theme applies CSS `filter: invert(1)` to the hero logo image.
- The SVG viewBox is `"0 20 85 85"` — if editing, ensure all 4 values are present.
